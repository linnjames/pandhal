<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="invoice_template_print">
        <t t-call="web.basic_layout">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <div width="100%" style="text-align: center;">
                        <img src='/web/binary/company_logo'
                             style="max-height: 25px;"
                             alt="Logo"/>
                    </div>
                    <div width="100%">
                        <table width="100%" style="font-weight: bold; border-color:white ;">
                            <tr>
                                <td align="center"
                                    style="vertical-align: middle; font-size: 9px;">
                                    <span t-field="doc.company_id.partner_id"
                                          t-options='{"widget": "contact", "fields": ["address", "phone", "email"], "no_marker": True}'/>
                                    <br/>
                                </td>
                            </tr>
                            <tr>
                                <td align="center"
                                    style="padding-top: 8px; vertical-align: middle; font-size: 10px;">
                                    CUSTOMER ORDER
                                </td>
                                <br></br>
                                <br></br>
                            </tr>
                        </table>
                        <br></br>
                    </div>
                    <div width="100%">
                        <table width="100%" style="font-weightF: bold; border-color:white ; font-size:9px;">
                            <tr>
                                <td style="font-size:10px">
                                    Customer :
                                    <span t-field="doc.partner_id.name"></span>
                                </td>
                                <td align="right">
                                    Date :
                                    <span t-field="doc.invoice_date"></span>
                                </td>
                            </tr>

                            <tr>
                                <td style="padding-top: 5px;" colspan="5"/>
                            </tr>
                        </table>
                        <table width="100%" style="font-weight: bold; border-color:white ; font-size:10px;">
                            <tr>
                                <td align="center">
                                    <span t-field="doc.name"></span>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <table width="100%"
                           style="font-weight: bold; page-break-inside: avoid; font-size:10px; border-color:white ;border-top: 1px solid black;">
                        <tr>
                            <td width="28%"
                                style="border-bottom: 1px solid black; vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                Product
                            </td>
                            <td align="center"
                                style="border-bottom: 1px solid black; vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                Qty
                            </td>
                            <td align="center"
                                style="border-bottom: 1px solid black; vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                Price
                            </td>
                            <td align="center"
                                style="border-bottom: 1px solid black; vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                Taxes
                            </td>
                            <td align="right"
                                style="border-bottom: 1px solid black; vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                Total
                            </td>
                        </tr>
                        <tr>
                            <td style="padding-top: 5px;" colspan="5"/>
                        </tr>
                        <t t-foreach="doc.invoice_line_ids" t-as="d">
                            <t t-if="d.product_id">
                                <tr>
                                    <td style="font-size: 9px; vertical-align: middle;">
                                        <span
                                                t-field="d.product_id.name" style="font-weight: bold;"/>
                                        <br/>

                                    </td>
                                    <td align="center"
                                        style="font-size: 9px; vertical-align: middle; font-weight: bold;">
                                        <span t-field="d.quantity"/>
                                        <span t-field="d.product_uom_id"/>
                                    </td>
                                    <td align="center"
                                        style="font-size: 9px; vertical-align: middle; font-weight: bold;">
                                        <span t-field="d.price_unit"/>
                                    </td>
                                    <td align="center"
                                        style="font-size: 9px; vertical-align: middle; font-weight: bold;">
                                        <span t-esc="', '.join(map(lambda x: (x.name), d.tax_ids))"/>
                                    </td>
                                    <td align="right"
                                        style="font-size: 9px; vertical-align: middle; font-weight: bold;">
                                        <span t-field="doc.currency_id.symbol"/>
                                        <span t-esc="'%.2f'%d.price_subtotal"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding-top: 7px;" colspan="5"/>
                                </tr>
                            </t>
                        </t>
                    </table>

                    <table width="100%"
                           style="font-weight: bold; page-break-inside: avoid; font-size:10px; border-color:white ;border-top: 1px solid black;">
                        <t t-set="tax" t-value="doc.invoice_line_ids.mapped('tax_ids')"/>
                        <t t-foreach="tax" t-as="line_tax">
                            <tr>
                                <td align="left"
                                    style="vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                    <b>SGST :</b>
                                    <span t-field="doc.currency_id.symbol"/>
                                    <t t-set="line"
                                       t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                    <!--                                                 ####Rounding Rule -->
                                    <t t-set="sgst" t-value="0"/>
                                    <t t-foreach="line" t-as="sg">

                                        <t t-set="sgst" t-value="sgst + round(sg.sgst_perc+10**(-2*2),2)"/>
                                        <!--                                            <t t-set="sgst" t-value="sum(line.mapped('sgst_perc'))"/>-->
                                    </t>
                                    <span t-esc="'%.2f'%(sgst * doc.convert_inr)"/>
                                </td>
                                <td align="right"
                                    style="vertical-align: middle; font-size:9px; padding-top: 5px; padding-bottom: 5px; font-weight: bold;">
                                    <b>CGST :</b>
                                    <span t-field="doc.currency_id.symbol"/>
                                    <t t-set="line"
                                       t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                    <t t-set="cgst" t-value="0"/>
                                    <t t-foreach="line" t-as="cg">
                                        <t t-set="cgst" t-value="cgst + round(cg.cgst_perc+10**(-2*2),2)"/>
                                    </t>
                                    <span t-esc="'%.2f'%(cgst * doc.convert_inr)"/>
                                </td>
                            </tr>
                        </t>
                    </table>


                    <table width="100%" style="font-weight: bold; page-break-inside: avoid;  border-color:white ;">
                        <tr>
                            <td colspan="2" style="border-top: 1px solid black;"/>
                        </tr>
                        <tr>
                            <td width="70%" align="right" style="vertical-align: middle; font-size:9px;">
                                Untaxed Amount
                            </td>
                            <td align="right" style="vertical-align: middle; font-size:8px;">
                                <span t-field="doc.currency_id.symbol"/>
                                <span t-esc="'%.2f'% doc.amount_untaxed"/>
                            </td>
                        </tr>
                        <tr>
                            <td width="70%" align="right" style="vertical-align: middle; font-size:9px;">
                                Total Discount
                            </td>
                            <td align="right" style="vertical-align: middle; font-size:8px;">
                                <span t-field="doc.currency_id.symbol"/>
                                <!--                                                        <span t-esc="'%.2f'% (doc.total_global_discount * doc.convert_inr)"/>-->
                                <span t-esc="'%.2f'% doc.discount_amt"/>
                            </td>
                        </tr>
                        <!--                        <tr>-->
                        <!--                            <td></td>-->
                        <!--                            <td colspan="11" style="padding: 5px 5px 5px 5px;">-->
                        <!--                                <span>Total Discount</span>-->
                        <!--                            </td>-->
                        <!--                            <td></td>-->
                        <!--                            &lt;!&ndash;                                        <td style="font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;border-bottom: none;">&ndash;&gt;-->
                        <!--                            <td style="font-weight: 800;border-right: 1px solid black;padding-left: 25px;border-bottom: none;">-->
                        <!--                                <span t-esc="doc.currency_id.symbol"/>-->
                        <!--                                <span t-esc="'%.2f'% doc.discount_amt"/>-->
                        <!--                            </td>-->
                        <!--                        </tr>-->
                        <tr>
                            <td width="70%" align="right" style="vertical-align: middle; font-size:10px;">Total
                                Amount
                            </td>
                            <td align="right" style="vertical-align: middle; font-size:10px;">
                                <span t-field="doc.currency_id.symbol"/>
                                <span t-esc="'%.2f'%doc.amount_total"/>
                            </td>
                        </tr>
                        <t t-set="payments_vals"
                           t-value="doc.sudo().invoice_payments_widget and doc.sudo().invoice_payments_widget['content'] or []"/>
                        <t t-foreach="payments_vals" t-as="payment_vals">
                            <tr t-if="payment_vals['is_exchange'] == 0">
                                <td width="70%" align="right" style="vertical-align: middle; font-size:10px;">
                                    <i class="oe_form_field text-end oe_payment_label">Paid on
                                        <t t-esc="payment_vals['date']" t-options='{"widget": "date"}'/>
                                    </i>
                                </td>
                                <td width="70%" align="right" style="vertical-align: middle; font-size:10px;"
                                    class="text-end">
                                    <span t-esc="payment_vals['amount']"
                                          t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                </td>
                            </tr>
                        </t>
                        <tr>
                            <td align="right" style="vertical-align: middle; font-size:10px;">
                                Amount Due
                            </td>
                            <td align="right" style="vertical-align: middle; font-size:10px;">
                                <span t-field="doc.amount_residual"/>
                            </td>
                        </tr>
                    </table>


                    <table width="100%" style="font-weight: bold;  border-color:white ;">
                        <tr>
                            <td align="center"
                                style="border-top: 1px solid black; vertical-align: middle; font-size: 15px; padding-top: 15px;">
                                THANK YOU
                                FOR SHOPPING
                            </td>
                        </tr>
                    </table>
                </t>
            </t>
        </t>
    </template>
</odoo>
