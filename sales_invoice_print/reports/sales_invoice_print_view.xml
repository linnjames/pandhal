<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <template id="record_sales_invoice_report_print">
            <t t-call="web.basic_layout">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="doc">
                        <style type="text/css">
                            .table_value_border_data {
                            vertical-align: middle;
                            border-right: 1px solid black;
                            border-left: 1px solid black;
                            border-bottom: 1px solid black;
                            }
                        </style>
                        <div class="page">
                            <div>
                                <table width="100%">
                                    <h4 align="center">
                                        <t t-if="doc.move_type == 'out_invoice'">
                                            <b>
                                                <span>Tax Invoice</span>
                                            </b>
                                        </t>
                                        <t t-elif="doc.move_type == 'out_refund'">
                                            <b>
                                                <span>Credit Note</span>
                                            </b>
                                        </t>
                                        <t t-elif="doc.move_type == 'in_invoice'">
                                            <b>
                                                <span>Purchase Invoice</span>
                                            </b>
                                        </t>
                                        <t t-elif="doc.move_type == 'in_refund'">
                                            <b>
                                                <span>Debit Note</span>
                                            </b>
                                        </t>
                                        <t t-else="">
                                            <b>
                                                <span t-field="doc.move_type"/>
                                            </b>
                                        </t>
                                    </h4>
                                    <tr>
                                        <td width="20%">
                                            <img src='/web/binary/company_logo'
                                                 style="width:80%; max-height:140pt;"
                                                 alt="Logo" align="center" valign="middle"/>
                                        </td>
                                        <td style="vertical-align:top;padding-left:50px;padding-top:30px;line-height:1;"
                                            width="50%" align="left">
                                            <span t-field="doc.company_id.name"/>
                                            <br/>
                                            <span t-field="doc.company_id.street"/>
                                            <span t-field="doc.company_id.street2"/>
                                            <br/>
                                            <span t-field="doc.company_id.city"/>,
                                            <span t-field="doc.company_id.state_id"/>,
                                            <span t-field="doc.company_id.zip"/>
                                            <br/>
                                            Call:
                                            <span t-field="res_company.partner_id.phone"/>
                                            <br/>
                                            Email:
                                            <span t-field="res_company.partner_id.email"/>
                                            <br/>

                                        </td>

<!--                                        <td style="vertical-align:top;" width="30%" rowspan="3">-->
<!--                                            <t t-if="to_text(doc.prnt_qr_code)">-->
<!--                                                <img t-att-src="'data:image/png;base64,%s' % to_text(doc.prnt_qr_code)"-->
<!--                                                     style="width:130%; height:175pt; align:left; padding-right:100px; "/>-->
<!--                                            </t>-->
<!--                                        </td>-->

                                    </tr>
                                    <tr>
                                        <td style="vertical-align: bottom; padding-top:60px;" colspan="4">
                                            GST IN
                                            :&amp;nbsp;&amp;nbsp;
<!--                                            <span t-field="doc.company_id.einv_gstin"/>-->
                                        </td>
                                    </tr>
<!--                                    <tr>-->
<!--                                        <t t-if="doc.ewaybill_no">-->
<!--                                            <td style="vertical-align: middle;" colspan="4">-->
<!--                                                Eway Bill No-->
<!--                                                :&amp;nbsp;&amp;nbsp;-->
<!--                                                <span t-field="doc.ewaybill_no"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                    </tr>-->

<!--                                    <tr>-->
<!--                                        <t t-if="doc.irn_no">-->
<!--                                            <td style="vertical-align: middle;" colspan="4">-->
<!--                                                IRN-->
<!--                                                :&amp;nbsp;&amp;nbsp;-->
<!--                                                <span t-field="doc.irn_no"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                    </tr>-->
<!--                                    <tr>-->
<!--                                        <t t-if="doc.ack_no">-->
<!--                                            <td style="vertical-align: middle;" colspan="4">-->
<!--                                                Acknowledgement No-->
<!--                                                :&amp;nbsp;&amp;nbsp;-->
<!--                                                <span t-field="doc.ack_no"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                    </tr>-->
<!--                                    <tr>-->
<!--                                        <t t-if="doc.ack_date">-->
<!--                                            <td style="vertical-align: middle;" colspan="4">-->
<!--                                                Acknowledge Date-->
<!--                                                :&amp;nbsp;&amp;nbsp;-->
<!--                                                <span t-field="doc.ack_date"/>-->
<!--                                            </td>-->
<!--                                        </t>-->
<!--                                    </tr>-->
                                    <t t-if="doc.ref">
                                        <tr>
                                            <td style="vertical-align: middle;" colspan="4">
                                                Customer Reference
                                                :&amp;nbsp;&amp;nbsp;
                                                <span t-field="doc.ref"/>
                                            </td>
                                        </tr>
                                    </t>
                                </table>
                            </div>
                            <div style="font-size:12px;" width="100%">
                                <table width="100%"
                                       style="font-size:12px;border:1px solid black;">
                                    <tr>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            <t t-if="doc.move_type == 'in_refund'">
                                                Debit Note No
                                            </t>
                                            <t t-elif="doc.move_type == 'out_refund'">
                                                Credit Note No
                                            </t>
                                            <t t-else="">
                                                Invoice No
                                            </t>
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            :&amp;nbsp;&amp;nbsp;
                                            <span t-field="doc.name"/>
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            Vehicle Number-->
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            :&amp;nbsp;&amp;nbsp;-->
<!--                                            <span t-field="doc.vehicle_no"/>-->
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            <t t-if="doc.move_type == 'in_refund'">
                                                Debit Note Date
                                            </t>
                                            <t t-elif="doc.move_type == 'out_refund'">
                                                Credit Note Date
                                            </t>
                                            <t t-else="">
                                                Invoice Date
                                            </t>
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            :&amp;nbsp;&amp;nbsp;
                                            <span t-field="doc.invoice_date"/>
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            Order Reference No-->
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            :&amp;nbsp;&amp;nbsp;-->
<!--                                            <span t-esc="doc.order_ref"/>-->
                                        </td>
                                    </tr>
                                    <t t-if="doc.move_type == 'in_refund'">
                                        <tr>
                                            <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                                Supplier Bill Reference
                                            </td>
                                            <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                                :&amp;nbsp;&amp;nbsp;
                                                <span t-field="doc.supplier_bill_ref"/>
                                            </td>
                                            <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                                Supplier Bill Date
                                            </td>
                                            <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                                :&amp;nbsp;&amp;nbsp;
                                                <t t-if="doc.supplier_bill_date">
                                                    <span t-esc="doc.supplier_bill_date.strftime('%d/%m/%Y')"/>
                                                </t>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            State(Code):
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
                                            :&amp;nbsp;&amp;nbsp;Kerala (32)
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            Terms-->
                                        </td>
                                        <td style="border:none;text-align:left;padding: 0px 0px 0px 5px;">
<!--                                            :&amp;nbsp;&amp;nbsp;-->
<!--                                            <span t-field="doc.terms_and_con"/>-->
                                        </td>

                                    </tr>
                                    <tr>
                                        <th colspan="2"
                                            style="border-bottom: 1px solid black;border-top: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 10px;background-color: #e5e5e5;text-align:center">
                                            <span>Details of Receiver (Billed To)</span>
                                        </th>
                                        <th colspan="2"
                                            style="border-bottom: 1px solid black;border-top: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 10px;background-color: #e5e5e5;text-align:center">
                                            <span>Details of Consignee (Shipped To)</span>
                                        </th>
                                    </tr>
                                    <tr>
                                        <td colspan="2"
                                            style="font-weight: 800;border-right: 1px solid black;text-align:left;padding: 0px 0px 0px 5px;">
                                            <span t-esc="doc.partner_id.name"/>
                                        </td>
                                        <!--                                        <td colspan="2"-->
                                        <!--                                            style="font-weight: 800;border-right: 1px solid black;text-align:left;padding: 0px 0px 0px 5px;">-->
                                        <!--                                            <span t-esc="doc.partner_id.name"/>-->
                                        <!--                                        </td>-->
                                        <td colspan="2"
                                            style="font-weight: 800;border-right: 1px solid black;text-align:left;padding: 0px 0px 0px 5px;">
                                            <t t-if="doc.is_ship_diff_address">
                                                <span t-field="doc.ship_legal_name"/>
                                            </t>
                                            <t t-else="">
                                                <span t-esc="doc.partner_id.name"/>
                                            </t>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td colspan="2"
                                            style="text-align:left;border-right: 1px solid black;padding: 10px 0px 0px 5px;">
                                            <span t-field="doc.partner_id"
                                                  t-options='{"widget": "contact", "fields": ["address", "phone"], "no_marker": True}'/>
                                        </td>
                                        <!--                                        <td colspan="2" style="text-align:left;padding: 10px 0px 0px 5px;">-->
                                        <!--                                            <span t-field="doc.partner_shipping_id"-->
                                        <!--                                                  t-options='{"widget": "contact", "fields": ["address", "phone"], "no_marker": True}'/>-->
                                        <!--                                        </td>-->
                                        <td colspan="2"
                                            style="text-align:left;padding: 10px 0px 0px 5px;">
                                            <t t-if="doc.is_ship_diff_address">
                                                <span t-field="doc.ship_add1"/>
                                                <br/>
                                                <span t-field="doc.ship_add2"/>
                                                <br/>
                                                <span t-field="doc.ship_loc"/>
                                                <br/>
                                                <span t-field="doc.ship_pin"/>
                                                <br/>
                                                <span t-field="doc.ship_state"/>
                                                <br/>
                                                <span t-field="doc.ship_st_code"/>
                                            </t>
                                            <t t-else="">
                                                <span t-field="doc.partner_shipping_id"
                                                      t-options='{"widget" : "contact", "fields": ["address", "phone"], "no_marker": True}'/>
                                            </t>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border-bottom: 1px solid black;text-align:left;padding: 5px 0px 0px 5px;">
                                            <span>GSTN</span>:&amp;nbsp;&amp;nbsp;
                                            <span t-field="doc.partner_id.vat"/>
                                        </td>
                                        <td style="border-right: 1px solid black;border-bottom: 1px solid black;text-align:left;padding: 5px 0px 0px 5px;">
                                        </td>
                                        <td style="border-bottom: 1px solid black;text-align:left;padding: 5px 0px 0px 5px;">
                                            <span>GSTN</span>:&amp;nbsp;&amp;nbsp;
                                            <t t-if="doc.is_ship_diff_address">
                                                <span t-field="doc.ship_gst"/>
                                            </t>
                                            <t t-else="">
                                                <span t-field="doc.partner_id.vat"/>
                                            </t>
                                        </td>
                                        <td style="border-right: 1px solid black;border-bottom: 1px solid black;text-align:left;padding: 5px 0px 0px 5px;">
                                        </td>
                                    </tr>
                                </table>

                                <table width="100%"
                                       style="font-size:12px;border:1px solid black;">
                                    <thead>
                                        <tr>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Sl No:
                                            </th>
                                            <th style="border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 5px;background-color: #e5e5e5;">
                                                Name of Product / Service
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                HSN
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Unit
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Qty
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Box
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Rate
                                            </th>
                                            <!--                                            <th style="border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 10px;background-color: #e5e5e5;">-->
                                            <!--                                                Less: Disc-->
                                            <!--                                            </th>-->
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Taxable Value
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                GST
                                            </th>
                                            <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                                Total
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-set="r_amt" t-value="0"/>
                                        <t t-foreach="doc.invoice_line_ids" t-as="line">
                                            <t t-if="not line.product_id">
                                                <t t-set="r_amt" t-value="line.price_subtotal"/>
                                            </t>
                                        </t>
                                        <t t-set="sl_no" t-value="0"/>
                                        <t t-set="qty_qty" t-value="0"/>
                                        <t t-set="sub_sum" t-value="0"/>
                                        <t t-set="tot_sum" t-value="0"/>
                                        <t t-foreach="doc.invoice_line_ids" t-as="val">
                                            <t t-if="val.product_id">
                                                <tr>
                                                    <t t-set="sl_no" t-value="sl_no + 1"/>
                                                    <t t-set="qty_qty" t-value="qty_qty + val.quantity"/>
                                                    <t t-set="sub_sum" t-value="sub_sum + val.price_subtotal"/>
                                                    <t t-set="tot_sum"
                                                       t-value="tot_sum + (val.price_subtotal + round(val.sgst_perc+10**(-2*2),2) + round(val.cgst_perc+10**(-2*2),2) + round(val.igst_perc+10**(-2*2),2) + round(val.cess+10**(-2*2),2))"/>
                                                    <td class="table_value_border_data" align="center">
                                                        <span t-esc="sl_no"/>
                                                    </td>
                                                    <td class="table_value_border_data" style="padding-left: 7px;">
                                                        <span t-field="val.name" t-options="{'widget': 'text'}"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="center">
                                                        <span t-esc="val.product_id.l10n_in_hsn_code"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="center">
                                                        <span t-field="val.product_id.uom_id"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="right"
                                                        style="padding-right: 7px;">
                                                        <span t-esc="val.quantity"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="center">
<!--                                                        <span t-esc="val.box"/>-->
                                                    </td>
                                                    <td class="table_value_border_data" align="right"
                                                        style="padding-right: 7px;">
                                                        <span t-esc="'%.2f'%(val.price_unit * doc.convert_inr)"/>
                                                    </td>
                                                    <!--                                                    <td>-->
                                                    <!--                                                        <span t-esc="val.discount_amount * doc.convert_inr"/>-->
                                                    <!--                                                    </td>-->
                                                    <td class="table_value_border_data" align="right"
                                                        style="padding-right: 7px;">
                                                        <span t-esc="'%.2f'%(val.price_subtotal * doc.convert_inr)"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="center">
                                                        <span t-esc="', '.join(map(lambda x: (x.description), val.tax_ids))"/>
                                                    </td>
                                                    <td class="table_value_border_data" align="right"
                                                        style="padding-right: 7px;">
                                                        <span t-esc="'%.2f'%((val.price_subtotal + round(val.sgst_perc+10**(-2*2),2) + round(val.cgst_perc+10**(-2*2),2) + round(val.igst_perc+10**(-2*2),2) + round(val.cess+10**(-2*2),2)) * doc.convert_inr)"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                        <tr>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none; vertical-align: middle;"
                                                align="center" colspan="3">
                                                Total
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none"/>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none; padding-right: 7px; vertical-align: middle;"
                                                class="text-right">
                                                <span t-esc="'%.2f'%qty_qty"/>
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none"/>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none"/>
<!--                                                                                            <td style="border-right: 1px solid black;border-top: 1px solid black;border-bottom: none">-->
<!--                                                                                            </td>-->
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none; padding-right: 7px; vertical-align: middle;"
                                                class="text-right">
                                                <span t-esc="'%.2f'%(sub_sum * doc.convert_inr)"/>
                                                <!--                                                <span t-esc="'%.2f'% ((doc.amount_untaxed - r_amt) * doc.convert_inr)"/>-->
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none; "/>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none; padding-right: 7px; vertical-align: middle;"
                                                class="text-right">
                                                <span t-esc="'%.2f'%(tot_sum * doc.convert_inr)"/>
                                                <!--                                                <span t-esc="'%.2f'% ((doc.amount_total - r_amt) * doc.convert_inr)"/>-->
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
<!--                                <br/>-->
                                <table width="49.5%"
                                       style="font-size:12px;border:1px solid black;page-break-inside:avoid;"
                                       align="left">
                                    <tr>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            Tax%
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 5px;background-color: #e5e5e5;">
                                            Taxable
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            SGST
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            CGST
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            IGST
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            Cess
                                        </th>
                                        <th style="text-align:center;border-bottom: 1px solid black;border-right: 1px solid black;padding: 1px 1px 1px 1px;background-color: #e5e5e5;">
                                            Total
                                        </th>
                                    </tr>
                                    <t t-set="tax" t-value="doc.invoice_line_ids.mapped('tax_ids')"/>

                                    <t t-foreach="tax" t-as="line_tax">
                                        <tr>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                t-attf-class="text-center {{ 'd-none d-md-table-cell'
                                                        if report_type == 'html' else '' }}">
                                                <span class="text-center"
                                                      t-esc="line_tax.description"/>
                                                <!--                                                    <span t-esc="', '.join(map(lambda x: (x.description or x.name), gst.tax_ids))"-->
                                                <!--                                                          id="line_tax_ids"/>-->
                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                                <t t-set="line"
                                                   t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                                <t t-set="price_tot"
                                                   t-value="sum(line.mapped('price_subtotal'))"/>
                                                <span class="text-nowrap"
                                                      t-esc="'%.2f'% (price_tot * doc.convert_inr)"/>
                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                                <t t-set="line"
                                                   t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                                <!--                                                ####Rounding Rule-->
                                                <t t-set="sgst" t-value="0"/>
                                                <t t-foreach="line" t-as="sg">
                                                    <t t-set="sgst"
                                                       t-value="sgst + round(sg.sgst_perc+10**(-2*2),2)"/>
                                                </t>
                                                <span t-esc="'%.2f'%(sgst * doc.convert_inr)"/>

                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                                <t t-set="line"
                                                   t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                                <!--                                                <t t-set="cgst"-->
                                                <!--                                                   t-value="sum(line.mapped('cgst_perc'))"/>-->
                                                <!--                                                <span class="text-nowrap"-->
                                                <!--                                                      t-esc="'%.2f'% (cgst* doc.convert_inr)"/>-->
                                                <t t-set="cgst" t-value="0"/>
                                                <t t-foreach="line" t-as="cg">
                                                    <t t-set="cgst"
                                                       t-value="cgst + round(cg.cgst_perc+10**(-2*2),2)"/>
                                                </t>
                                                <span t-esc="'%.2f'%(cgst * doc.convert_inr)"/>
                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                                <t t-set="line"
                                                   t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                                <!--                                                <t t-set="igst"-->
                                                <!--                                                   t-value="sum(line.mapped('igst_perc'))"/>-->
                                                <!--                                                <span class="text-nowrap"-->
                                                <!--                                                      t-esc="'%.2f'% (igst* doc.convert_inr)"/>-->
                                                <t t-set="igst" t-value="0"/>
                                                <t t-foreach="line" t-as="ig">
                                                    <t t-set="igst"
                                                       t-value="igst + round(ig.igst_perc+10**(-2*2),2)"/>
                                                </t>
                                                <span t-esc="'%.2f'%(igst * doc.convert_inr)"/>
                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                            </td>
                                            <td style=" font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;"
                                                class="text-right">
                                                <t t-set="line"
                                                   t-value="doc.invoice_line_ids.filtered(lambda line: line.tax_ids == line_tax)"/>
                                                <t t-set="price_sub"
                                                   t-value="sum(line.mapped('price_subtotal'))"/>
                                                <span class="text-nowrap"
                                                      t-esc="'%.2f'% ((price_sub * doc.convert_inr) + igst * doc.convert_inr + cgst * doc.convert_inr + sgst * doc.convert_inr)"/>
                                            </td>
                                        </tr>

                                    </t>
                                    <t t-set="tax_sgst" t-value="0"/>
                                    <t t-set="tax_cgst" t-value="0"/>
                                    <t t-set="tax_igst" t-value="0"/>
                                    <t t-foreach="doc.invoice_line_ids" t-as="tax_sum">
                                        <t t-set="tax_sgst" t-value="tax_sgst + round(tax_sum.sgst_perc+10**(-2*2),2)"/>
                                        <t t-set="tax_cgst" t-value="tax_cgst + round(tax_sum.cgst_perc+10**(-2*2),2)"/>
                                        <t t-set="tax_igst" t-value="tax_igst + round(tax_sum.igst_perc+10**(-2*2),2)"/>
                                    </t>
                                    <tr>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none"
                                            align="center" colspan="1">
                                            Total
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <span t-esc="'%.2f'% ((doc.amount_untaxed - r_amt) * doc.convert_inr) "/>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <t t-set="linesss"
                                               t-value="doc.invoice_line_ids.sorted(key=lambda l:(-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>
                                            <!--                                            <span t-esc="'%.2f'% (sum(linesss.mapped('sgst_perc'))* doc.convert_inr)"/>-->
                                            <span t-esc="'%.2f'%(tax_sgst * doc.convert_inr)"/>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <!--                                            <span t-esc="'%.2f'% (sum(linesss.mapped('cgst_perc'))* doc.convert_inr)"/>-->
                                            <span t-esc="'%.2f'%(tax_cgst * doc.convert_inr)"/>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <!--                                            <span t-esc="'%.2f'% (sum(linesss.mapped('igst_perc'))* doc.convert_inr)"/>-->
                                            <span t-esc="'%.2f'%(tax_igst * doc.convert_inr)"/>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <!--                                                <span t-esc="'%.2f'% doc.amount_untaxed "/>-->
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;"
                                            class="text-right">
                                            <!--                                            <span t-esc="'%.2f'% (((doc.amount_untaxed - r_amt) * doc.convert_inr)+(sum(linesss.mapped('sgst_perc'))* doc.convert_inr)+(sum(linesss.mapped('cgst_perc'))* doc.convert_inr)+(sum(linesss.mapped('igst_perc'))* doc.convert_inr))"/>-->
                                            <span t-esc="'%.2f'% (((doc.amount_untaxed - r_amt) * doc.convert_inr)+(tax_sgst * doc.convert_inr)+(tax_cgst * doc.convert_inr)+(tax_igst * doc.convert_inr))"/>
                                        </td>
                                    </tr>
                                </table>

                                <table width="50.5%"
                                       style="font-size:12px;border:1px solid black; page-break-inside:avoid;"
                                       align="left">

                                    <tr>
                                        <td></td>
                                        <td style="padding: 5px 5px 5px 5px;">
                                            <span>Total Amount Before Tax</span>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;border-top: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;">
                                            <span t-esc="'%.2f'% ((doc.amount_untaxed - r_amt) * doc.convert_inr)"/>
                                        </td>
                                        <!--                                            <td></td>-->
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <t t-if="sum(linesss.mapped('sgst_perc')) !=0">
                                            <td style="padding: 5px 5px 5px 5px;">
                                                <span>SGST</span>
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;">
                                                <t t-set="linesss"
                                                   t-value="doc.invoice_line_ids.sorted(key=lambda l:(-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>
                                                <!--                                                <span t-esc="'%.2f'% (sum(linesss.mapped('sgst_perc'))* doc.convert_inr)"/>-->
                                                <!--                                                <t t-set="rrr" t-value="0"/>-->
                                                <span t-esc="'%.2f'%(tax_sgst * doc.convert_inr)"/>
                                            </td>
                                        </t>
                                        <!--                                            <td></td>-->
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <t t-if="sum(linesss.mapped('cgst_perc')) !=0">
                                            <td style="padding: 5px 5px 5px 5px;">
                                                <span>CGST</span>
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;">
                                                <!--                                                <span t-esc="'%.2f'% (sum(linesss.mapped('cgst_perc'))* doc.convert_inr)"/>-->
                                                <span t-esc="'%.2f'%(tax_cgst * doc.convert_inr)"/>
                                            </td>
                                        </t>
                                        <!--                                            <td></td>-->
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <t t-if="sum(linesss.mapped('igst_perc')) !=0">
                                            <td style="padding: 5px 5px 5px 5px;">
                                                <span>IGST</span>
                                            </td>
                                            <td style="font-weight: 800;border-right: 1px solid black;border-bottom: none;padding: 2px 2px 2px 2px;">
                                                <!--                                                <span t-esc="'%.2f'% (sum(linesss.mapped('igst_perc')) * doc.convert_inr)"/>-->
                                                <span t-esc="'%.2f'%(tax_igst * doc.convert_inr)"/>
                                            </td>
                                        </t>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td style="padding: 5px 5px 5px 5px;">
                                            <span>Less: Extra Discount</span>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;">
                                            <span t-esc="'%.2f'% (doc.total_global_discount * doc.convert_inr)"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td style="padding: 5px 5px 5px 5px;">
                                            <span>Round off Amount</span>
                                        </td>
                                        <td style="font-weight: 800;border-right: 1px solid black;padding: 2px 2px 2px 2px;">
                                            <span t-esc="'%.2f'% (r_amt * doc.convert_inr)"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td style="padding: 5px 5px 5px 5px;">
                                            <span>TOTAL AMOUNT</span>
                                        </td>
                                        <td style="font-weight: 800;font-size: 16px;border-right: 1px solid black;padding: 2px 2px 2px 2px;">
<!--                                                                                        <t t-if="doc.convert_inr &gt; 0">-->
<!--                                                                                            <span t-esc="'%.2f'%(doc.amount_total * doc.convert_inr)"/>-->
<!--                                                                                        </t>-->
<!--                                                                                        <t t-else="">-->
<!--                                                                                            <span t-esc="'%.2f'%doc.amount_total"/>-->
<!--                                                                                        </t>-->
                                            <t t-set="dis" t-value="doc.total_global_discount * doc.convert_inr"/>
<!--                                            <span t-esc="'%.2f'% ((((doc.amount_untaxed - r_amt) * doc.convert_inr)+(r_amt * doc.convert_inr)+(tax_sgst * doc.convert_inr)+(tax_cgst * doc.convert_inr)+(tax_igst * doc.convert_inr)) - dis)"/>-->
                                                                                        <span t-esc="'%.2f'% (((((doc.amount_untaxed - r_amt) * doc.convert_inr))+(r_amt * doc.convert_inr)+(sum(linesss.mapped('sgst_perc'))* doc.convert_inr)+(sum(linesss.mapped('cgst_perc'))* doc.convert_inr)+(sum(linesss.mapped('igst_perc'))* doc.convert_inr)) - dis)"/>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="6"
                                            style="border-right: 1px solid black;padding: 10px 5px 5px 10px;">
                                            <strong>Amount in Words&amp;nbsp;:&amp;nbsp;
                                            </strong>
                                            <span t-esc="doc.amount_in_words"/>
<!--                                                                                        <span t-esc="doc.sales_amount_in_words"/>-->
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <br/>
                        <br/>
                        <br/>

                        <tr>
                            <!--                            <t t-if="doc.inv_terms">-->
                            <!--                                <span>Terms-->
                            <!--                                    :&amp;nbsp;-->
                            <!--                                    <span t-field="doc.inv_terms"/>-->
                            <!--                                </span>-->
                            <!--                            </t>-->

                        </tr>


                        <!--                        </div>-->
                        <div class="footer">
                            <div class="last-page">
                                <hr style="background-color:black"/>

                                <div width="100%" class="row">
                                    <table width="30%">
                                        <tr>
                                            <td align="left">
                                                <strong>Bank Details</strong>
                                            </td>
                                            <td></td>
                                        </tr>
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span>Payee-->
<!--                                                    :&amp;nbsp;-->
<!--                                                    <span t-field="doc.company_id.name"/>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span>Acc No.-->
<!--                                                    :&amp;nbsp;-->
<!--                                                    <span t-field="doc.company_id.acc_number"/>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span>Bank-->
<!--                                                    :&amp;nbsp;-->
<!--                                                    <span t-field="doc.company_id.acc_bank_name"/>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span>Branch-->
<!--                                                    :&amp;nbsp;-->
<!--                                                    <span t-field="doc.company_id.bank_branch"/>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <span>IFSC-->
<!--                                                    :&amp;nbsp;-->
<!--                                                    <span t-field="doc.company_id.bank_ifsc"/>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->

<!--                                    </table>-->
<!--                                    <table width="10%">-->
<!--                                        <tr>-->
<!--                                            <th style="align:center;">-->
<!--                                                <b>Scan &amp; Pay</b>-->
<!--                                            </th>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <img t-att-src="'data:image/png;base64,%s' % to_text(doc.company_id.code_qr)"-->
<!--                                                     style="width:100%; max-height:150pt;max-width:160pt;"/>-->
<!--                                            </td>-->
<!--                                        </tr>-->

<!--                                    </table>-->
<!--                                    <table width="60%">-->
<!--                                        <tr>-->
<!--                                            <td align="right">-->
<!--                                                <span>Certified that the particulars given above are true and correct.-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td align="right">-->
<!--                                                <span>-->
<!--                                                    <strong>For,-->
<!--                                                        <span t-field="doc.company_id.name"/>-->
<!--                                                    </strong>-->
<!--                                                </span>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td style="padding-left: 10px;" align="left">-->
<!--                                                <t t-if="doc.show_fssai == True">-->
<!--                                                    <span>-->
<!--                                                        FSSAI No:-->
<!--                                                        <span t-field="doc.company_id.fssai_no"/>-->
<!--                                                    </span>-->
<!--                                                </t>-->
<!--                                            </td>-->
<!--                                        </tr>-->
                                        <tr>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                        </tr>

                                        <tr>
                                            <td align="right" style="padding-top:50px">
                                                <strong>Authorised Signature E &amp; OE</strong>
                                            </td>
                                        </tr>

                                    </table>
                                </div>
                            </div>
                            <p align="center">
                                <b>DECLARATION:</b>
                                SUBJECT TO ALUVA JURISDICTION
                                <br/>
                                This is computer generated Invoice.
                            </p>
                        </div>


                        <!--                            &lt;!&ndash;                            <div align="center" style="font-size:12px;">&ndash;&gt;-->
                        <!--                            &lt;!&ndash;                                <span class="page"/>/&ndash;&gt;-->
                        <!--                            &lt;!&ndash;                                <span class="topage"/>&ndash;&gt;-->
                        <!--                            &lt;!&ndash;                            </div>&ndash;&gt;-->
                        <!--                        </div>-->
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>